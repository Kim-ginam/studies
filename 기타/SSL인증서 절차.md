# SSL인증서 절차

### 서버 인증서의 구조

```
서버의 도메인 이름
서버의 공개 키
인증서 발급자(CA)의 이름
인증서의 유효 기간
CA의 디지털 서명
```

### 절차
1. 클라이언트가 CA로부터 발급받은 인증서로 서비스하는 서버와 연결

2. 서버가 전송한 인증서가 CA로부터 제대로 발급받은 것인지 확인.

3. 클라이언트는 CA와 공개키 목록 (루트 인증서)를 보유(신뢰하고 있음)
	1. 서버에서 인증서를 보내면 
	2. CA 서명을 공개키로 추출하여 해싱값을 얻고
	3. 서버에서 보낸 CA 디지털 서명에 있는 어떤 해싱함수를 사용했는지 알아내서 그 해싱함수로 서명을 해싱
	4. 공개키를 사용하여 얻은 해싱값과 비교 맞을경우 신뢰할 수 있는 기관이다

4. 신뢰할 수 있는 CA로부터 발급된 인증서라고 확인을 마치면 CA의 공개키를 이용하여 인증서 복호화

5. 세션키 값을 만들어 인증서에 저장된 서버의 공개키로 암호화하여 서버로 전송 진행

6. 세션키로 암호화된 요청 전송 


### PKIX path building failed 에러
- 클라이언트와 서버가 SSL/TLS 연결을 설정하는 과정에서, 클라이언트가 서버의 인증서를 받아 이를 검증할 때 발생하는 에러

- JVM에 신뢰하는 인증서가 없기 때문이고 CA기관으로 부터 루트 인증서를 받아 추가가 필요함
keytool -import -alias mycert -keystore $JAVA_HOME/lib/security/cacerts -file 인증기관.crt
- 인증기관 목록, 공개키, 루트 인증서 추가
